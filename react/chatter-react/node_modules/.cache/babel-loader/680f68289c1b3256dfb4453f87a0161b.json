{"ast":null,"code":"var _jsxFileName = \"/home/xeg/dev/chatter-web/frontend/react/chatter-react/src/App.tsx\",\n    _s = $RefreshSig$();\n\nimport { useMutation } from \"@apollo/client\";\nimport React, { createContext, useEffect, useState } from \"react\";\nimport { useCookies } from \"react-cookie\";\nimport Layout from \"./components/Layout/Layout\";\nimport { ADD_NEW_USER, IS_LOBBY_EXISTING } from \"./components/Queries/App\";\nimport LobbyModal from \"./components/Lobby/LobbyModal\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const UsrContxt = /*#__PURE__*/createContext({\n  username: \"\",\n  userId: \"\",\n  lobbyId: \"\",\n  setUsername: username => {}\n});\n\nfunction App() {\n  _s();\n\n  const [username, setUsername] = useState(\"\");\n  const [userId, setUserId] = useState(\"\");\n  const [lobbyId, setLobbyId] = useState(\"633c71d566f605851babba3e\");\n  const [userCookie, setUserCookie] = useCookies([\"user-cookie\"]); // TODO ADD PROPER TYPES\n\n  const [newUser, newUserQueryRes] = useMutation(ADD_NEW_USER);\n  const [newLobby, newLobbyQueryRes] = useMutation(IS_LOBBY_EXISTING);\n\n  const createLobby = () => {\n    // todo create loading screen when loading a lobby\n    console.log(\"creating lobby...\");\n  };\n\n  const handleSetUsername = username => {\n    setUsername(username);\n  };\n\n  useEffect(() => {\n    if (!(userCookie !== null && userCookie !== void 0 && userCookie[\"user-cookie\"])) {\n      newUser();\n    } else {\n      const {\n        userId,\n        username\n      } = userCookie[\"user-cookie\"];\n      setUsername(username);\n      setUserId(userId);\n    }\n  }, []);\n  useEffect(() => {\n    if (newUserQueryRes.data) {\n      let {\n        code,\n        success,\n        user\n      } = newUserQueryRes.data.addNewUser;\n\n      if (code === 200 && success) {\n        setUsername(user.username);\n        setUserId(user.id);\n        setUserCookie(\"user-cookie\", {\n          userId: user.id,\n          username: user.username\n        }, {\n          path: \"/\",\n          expires: new Date(\"11-10-2023\")\n        });\n      }\n    }\n  }, [newUserQueryRes.data]); // todo proper loading\n\n  if (newUserQueryRes.loading || newUserQueryRes.error) return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: \"LOADING\"\n  }, void 0, false);\n  return /*#__PURE__*/_jsxDEV(UsrContxt.Provider, {\n    value: {\n      username,\n      setUsername: handleSetUsername,\n      userId,\n      lobbyId\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(LobbyModal, {\n        opened: true,\n        createLobby: createLobby\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Layout, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"e4HU68i8ove8XPIucU+Q+Fmqh+M=\", false, function () {\n  return [useCookies, useMutation, useMutation];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useMutation","React","createContext","useEffect","useState","useCookies","Layout","ADD_NEW_USER","IS_LOBBY_EXISTING","LobbyModal","UsrContxt","username","userId","lobbyId","setUsername","App","setUserId","setLobbyId","userCookie","setUserCookie","newUser","newUserQueryRes","newLobby","newLobbyQueryRes","createLobby","console","log","handleSetUsername","data","code","success","user","addNewUser","id","path","expires","Date","loading","error"],"sources":["/home/xeg/dev/chatter-web/frontend/react/chatter-react/src/App.tsx"],"sourcesContent":["import { MutationTuple, useMutation } from \"@apollo/client\";\nimport React, { createContext, useEffect, useState } from \"react\";\nimport { useCookies } from \"react-cookie\";\nimport UserContext from \"./components/Chatter/interface/UserContext\";\nimport Layout from \"./components/Layout/Layout\";\nimport { ADD_NEW_USER, IS_LOBBY_EXISTING } from \"./components/Queries/App\";\nimport LobbyModal from \"./components/Lobby/LobbyModal\";\n\nexport const UsrContxt = createContext<UserContext>({\n  username: \"\",\n  userId: \"\",\n  lobbyId: \"\",\n  setUsername: (username: string) => {},\n});\n\nfunction App(): JSX.Element {\n  const [username, setUsername] = useState<string>(\"\");\n  const [userId, setUserId] = useState<string>(\"\");\n  const [lobbyId, setLobbyId] = useState<string>(\"633c71d566f605851babba3e\");\n  const [userCookie, setUserCookie] = useCookies([\"user-cookie\"]);\n\n  // TODO ADD PROPER TYPES\n  const [newUser, newUserQueryRes]: MutationTuple<any, any> =\n    useMutation(ADD_NEW_USER);\n\n  const [newLobby, newLobbyQueryRes]: MutationTuple<any, any> =\n    useMutation(IS_LOBBY_EXISTING);\n\n  const createLobby = () => {\n    // todo create loading screen when loading a lobby\n    console.log(\"creating lobby...\");\n  };\n\n  const handleSetUsername = (username: string) => {\n    setUsername(username);\n  };\n\n  useEffect(() => {\n    if (!userCookie?.[\"user-cookie\"]) {\n      newUser();\n    } else {\n      const { userId, username } = userCookie[\"user-cookie\"];\n      setUsername(username);\n      setUserId(userId);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (newUserQueryRes.data) {\n      let { code, success, user } = newUserQueryRes.data.addNewUser;\n      if (code === 200 && success) {\n        setUsername(user.username);\n        setUserId(user.id);\n        setUserCookie(\n          \"user-cookie\",\n          { userId: user.id, username: user.username },\n          {\n            path: \"/\",\n            expires: new Date(\"11-10-2023\"),\n          }\n        );\n      }\n    }\n  }, [newUserQueryRes.data]);\n\n  // todo proper loading\n  if (newUserQueryRes.loading || newUserQueryRes.error) return <>LOADING</>;\n\n  return (\n    <UsrContxt.Provider\n      value={{ username, setUsername: handleSetUsername, userId, lobbyId }}\n    >\n      <div className=\"App\">\n        <LobbyModal opened={true} createLobby={createLobby} />\n        <Layout />\n      </div>\n    </UsrContxt.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}