{"ast":null,"code":"var _jsxFileName = \"/home/xeg/dev/chatter-web/frontend/react/chatter-react/src/components/Video/Video.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useRef, useState } from \"react\";\nimport Box from \"@mui/material/Box\";\nimport YouTube from \"react-youtube\";\nimport { useContainerDimension } from \"../../util/ResizeUtil\";\nimport { useSubscription } from \"@apollo/client\";\nimport { VIDEO_STATUS_SUBSCRIPTION } from \"../../queries/Video\";\nimport { UsrContxt } from \"../../App\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar PlayerState;\n\n(function (PlayerState) {\n  PlayerState[PlayerState[\"UNSTARTED\"] = -1] = \"UNSTARTED\";\n  PlayerState[PlayerState[\"ENDED\"] = 0] = \"ENDED\";\n  PlayerState[PlayerState[\"PLAYING\"] = 1] = \"PLAYING\";\n  PlayerState[PlayerState[\"PAUSED\"] = 2] = \"PAUSED\";\n  PlayerState[PlayerState[\"BUFFERING\"] = 3] = \"BUFFERING\";\n  PlayerState[PlayerState[\"VIDEO_CUED\"] = 5] = \"VIDEO_CUED\";\n})(PlayerState || (PlayerState = {}));\n\nfunction Video(_ref) {\n  _s();\n\n  let {\n    videoId\n  } = _ref;\n  const [videoState, setVideoState] = useState({\n    videoId: videoId,\n    playerState: PlayerState.UNSTARTED,\n    onStateChange: onStateChange,\n    onReady: onReadyHandler,\n    onPlay: onPlayHandler,\n    onPause: onPauseHandler,\n    onEnd: onEndHandler,\n    onError: onErrorHandler,\n    opts: {\n      width: \"\",\n      height: \"\"\n    }\n  });\n  const ytContainer = useRef(null);\n  const videoSize = useContainerDimension(ytContainer);\n  const userContext = useContext(UsrContxt);\n  const videoChanges = useSubscription(VIDEO_STATUS_SUBSCRIPTION, {\n    variables: {\n      lobbyId: userContext.lobbyId,\n      userId: userContext.userId\n    }\n  });\n  const videoContainerStyle = {\n    display: \"flex\"\n  };\n\n  function onStateChange(event) {\n    setVideoState(prev => ({ ...prev,\n      playerState: getPlayerState(event.data)\n    }));\n  }\n\n  function onReadyHandler(event) {}\n\n  function onPlayHandler(event) {}\n\n  function onPauseHandler(event) {}\n\n  function onEndHandler(event) {}\n\n  function onErrorHandler(event) {}\n\n  useEffect(() => {\n    var _videoChanges$data;\n\n    if (videoChanges !== null && videoChanges !== void 0 && (_videoChanges$data = videoChanges.data) !== null && _videoChanges$data !== void 0 && _videoChanges$data.videoStatusChanged) {\n      console.log(videoChanges);\n    }\n  }, [videoChanges.data]);\n\n  const getPlayerState = eventData => {\n    switch (eventData) {\n      case 0:\n        return PlayerState.ENDED;\n\n      case 1:\n        return PlayerState.PLAYING;\n\n      case 2:\n        return PlayerState.PAUSED;\n\n      case 3:\n        return PlayerState.BUFFERING;\n\n      case 5:\n        return PlayerState.VIDEO_CUED;\n\n      default:\n        return PlayerState.UNSTARTED;\n    }\n  };\n\n  useEffect(() => {\n    setVideoState(prevState => ({ ...prevState,\n      opts: {\n        width: videoSize.width + \"\",\n        height: videoSize.height + \"\"\n      }\n    }));\n  }, [videoSize]);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: videoContainerStyle,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"70vw\",\n        height: \"99vh\"\n      },\n      ref: ytContainer,\n      children: /*#__PURE__*/_jsxDEV(YouTube, { ...videoState\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Video, \"QswS+l5EzLymHqye+XLEz/XTQ2w=\", false, function () {\n  return [useContainerDimension, useSubscription];\n});\n\n_c = Video;\nexport default Video;\n\nvar _c;\n\n$RefreshReg$(_c, \"Video\");","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","Box","YouTube","useContainerDimension","useSubscription","VIDEO_STATUS_SUBSCRIPTION","UsrContxt","PlayerState","Video","videoId","videoState","setVideoState","playerState","UNSTARTED","onStateChange","onReady","onReadyHandler","onPlay","onPlayHandler","onPause","onPauseHandler","onEnd","onEndHandler","onError","onErrorHandler","opts","width","height","ytContainer","videoSize","userContext","videoChanges","variables","lobbyId","userId","videoContainerStyle","display","event","prev","getPlayerState","data","videoStatusChanged","console","log","eventData","ENDED","PLAYING","PAUSED","BUFFERING","VIDEO_CUED","prevState"],"sources":["/home/xeg/dev/chatter-web/frontend/react/chatter-react/src/components/Video/Video.tsx"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport Box from \"@mui/material/Box\";\nimport YouTube, { YouTubeEvent } from \"react-youtube\";\nimport { SxProps } from \"@mui/system\";\nimport { useContainerDimension } from \"../../util/ResizeUtil\";\nimport { SubscriptionResult, useSubscription } from \"@apollo/client\";\nimport VideoStatusResponse from \"./interface/response/VideoStatusTopicResponse\";\nimport { VIDEO_STATUS_SUBSCRIPTION } from \"../../queries/Video\";\nimport { UsrContxt } from \"../../App\";\n\ninterface VideoProps {\n  videoId: string;\n}\n\ninterface LobbyIdProps {\n  lobbyId: string;\n}\ninterface UserIdProps {\n  userIdProps: string;\n}\n\nenum PlayerState {\n  UNSTARTED = -1,\n  ENDED = 0,\n  PLAYING = 1,\n  PAUSED = 2,\n  BUFFERING = 3,\n  VIDEO_CUED = 5,\n}\n\ninterface State {\n  playerState: PlayerState;\n  videoId: string;\n  onStateChange(event: YouTubeEvent<number>): void;\n  onReady(event: YouTubeEvent<number>): void;\n  onPlay(event: YouTubeEvent<number>): void;\n  onPause(event: YouTubeEvent<number>): void;\n  onEnd(event: YouTubeEvent<number>): void;\n  onError(event: YouTubeEvent<number>): void;\n  opts: {\n    width: string;\n    height: string;\n  };\n}\n\nfunction Video({ videoId }: VideoProps): JSX.Element {\n  const [videoState, setVideoState] = useState<State>({\n    videoId: videoId,\n    playerState: PlayerState.UNSTARTED,\n    onStateChange: onStateChange,\n    onReady: onReadyHandler,\n    onPlay: onPlayHandler,\n    onPause: onPauseHandler,\n    onEnd: onEndHandler,\n    onError: onErrorHandler,\n    opts: {\n      width: \"\",\n      height: \"\",\n    },\n  });\n  const ytContainer = useRef<HTMLDivElement>(null);\n  const videoSize = useContainerDimension(ytContainer);\n  const userContext = useContext(UsrContxt);\n\n  const videoChanges: SubscriptionResult<\n    { videoStatusChanged: VideoStatusResponse },\n    { lobbyId: LobbyIdProps; userId: UserIdProps }\n  > = useSubscription(VIDEO_STATUS_SUBSCRIPTION, {\n    variables: {\n      lobbyId: userContext.lobbyId,\n      userId: userContext.userId,\n    },\n  });\n\n  const videoContainerStyle: SxProps = {\n    display: \"flex\",\n  };\n\n  function onStateChange(event: YouTubeEvent<number>): void {\n    setVideoState((prev: State) => ({\n      ...prev,\n      playerState: getPlayerState(event.data),\n    }));\n  }\n\n  function onReadyHandler(event: YouTubeEvent<number>): void {}\n\n  function onPlayHandler(event: YouTubeEvent<number>): void {}\n\n  function onPauseHandler(event: YouTubeEvent<number>): void {}\n\n  function onEndHandler(event: YouTubeEvent<number>): void {}\n\n  function onErrorHandler(event: YouTubeEvent<number>): void {}\n\n  useEffect(() => {\n    if (videoChanges?.data?.videoStatusChanged) {\n      console.log(videoChanges);\n    }\n  }, [videoChanges.data]);\n\n  const getPlayerState = (eventData: number): PlayerState => {\n    switch (eventData) {\n      case 0:\n        return PlayerState.ENDED;\n      case 1:\n        return PlayerState.PLAYING;\n      case 2:\n        return PlayerState.PAUSED;\n      case 3:\n        return PlayerState.BUFFERING;\n      case 5:\n        return PlayerState.VIDEO_CUED;\n      default:\n        return PlayerState.UNSTARTED;\n    }\n  };\n\n  useEffect(() => {\n    setVideoState((prevState: State) => ({\n      ...prevState,\n      opts: {\n        width: videoSize.width + \"\",\n        height: videoSize.height + \"\",\n      },\n    }));\n  }, [videoSize]);\n\n  return (\n    <Box sx={videoContainerStyle}>\n      <div style={{ width: \"70vw\", height: \"99vh\" }} ref={ytContainer}>\n        <YouTube {...videoState}></YouTube>\n      </div>\n    </Box>\n  );\n}\n\nexport default Video;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}